databaseChangeLog:
  - changeSet:
      id: 1584695437711-1
      author: lei-eb
      changes:
        - dropForeignKeyConstraint:
            baseTableName: benefit_plans_users
            constraintName: fk_benefit_plan_coverages_id

  - changeSet:
      id: 1584695437711-2
      author: lei-eb
      preConditions:
        onFail: WARN
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: coverage_id
            baseTableName: benefit_plans_users
            constraintName: fk_benefit_plan_coverages_id
            onDelete: CASCADE
            onUpdate: CASCADE
            referencedColumnNames: id
            referencedTableName: benefit_plan_coverages

  - changeSet:
      id: 1585130225991-1
      author: bin-eb
      changes:
        - createTable:
            columns:
              - column:
                  name: id
                  type: binary(16)
              - column:
                  name: user_id
                  type: binary(16)
              - column:
                  name: content
                  type: text
              - column:
                  name: is_past_announcement
                  type: bool
                  defaultValue: true
              - column:
                  name: created_at
                  type: datetime
              - column:
                  name: updated_at
                  type: datetime
            tableName: system_announcements
  - changeSet:
      id: 1585031192962-1
      author: qian-eb
      preConditions:
        onFail: WARN
      changes:
        - addColumn:
            columns:
              - column:
                  name: is_auto_enroll_enabled
                  type: bool
                  defaultValue: false
            tableName: time_off_policies

  - changeSet:
      id: 1585291440465-1
      author: bin-eb
      changes:
        - createTable:
            columns:
              - column:
                  name: id
                  type: binary(16)
                  constraints:
                    primaryKey: true
              - column:
                  name: user_id
                  type: binary(16)
              - column:
                  name: system_announcement_id
                  type: binary(16)
              - column:
                  name: created_at
                  type: datetime
              - column:
                  name: updated_at
                  type: datetime
            tableName: dismissed_at

  - changeSet:
      id: 1586827241004-0
      author: qian-eb
      preConditions:
        onFail: WARN
      changes:
        - sql:
            sql: alter table emails change from_name from_name varchar(255) character set utf8mb4;
  - changeSet:
      id: 1586827241004-1
      author: qian-eb
      preConditions:
        onFail: WARN
      changes:
        - sql:
            sql: alter table emails change to_name to_name varchar(255) character set utf8mb4;
  - changeSet:
      id: 1586827241004-2
      author: qian-eb
      preConditions:
        onFail: WARN
      changes:
        - sql:
            sql: alter table emails change content content text character set utf8mb4;
  - changeSet:
      id: 1586827241004-3
      author: qian-eb
      preConditions:
        onFail: WARN
      changes:
        - sql:
            sql: alter table time_off_request_comments change comment comment text character set utf8mb4;

  - changeSet:
      id: 1589963373000-1
      author: michael-eb
      changes:
        - createTable:
            columns:
              - column:
                  name: id
                  type: binary(16)
                  constraints:
                    primaryKey: true
              - column:
                  name: company_id
                  type: binary(16)
                  constraints:
                    nullable:  false
              - column:
                  name: time_zone_id
                  type: binary(16)
              - column:
                  name: pay_frequency_type_id
                  type: binary(16)
              - column:
                  name: approval_days_before_payroll
                  type: int
                  constraints:
                    nullable:  false
              - column:
                  name: last_payroll_payday
                  type: datetime
              - column:
                  name: created_at
                  type: datetime
              - column:
                  name: updated_at
                  type: datetime
            tableName: company_ta_settings

  - changeSet:
      id: 1589963373000-2
      author: michael-eb
      changes:
        - createTable:
            columns:
              - column:
                  name: id
                  type: binary(16)
                  constraints:
                    primaryKey: true
              - column:
                  name: employee_id
                  type: binary(16)
              - column:
                  name: time_zone_id
                  type: binary(16)
              - column:
                  name: messaging_on
                  type: tinyint(1)
              - column:
                  name: created_at
                  type: datetime
              - column:
                  name: updated_at
                  type: datetime
            tableName: employees_ta_settings

  - changeSet:
      id: 1589963373000-3
      author: michael-eb
      changes:
        - createTable:
            columns:
              - column:
                  name: id
                  type: binary(16)
                  constraints:
                    primaryKey: true
              - column:
                  name: name
                  type: varchar(128)
              - column:
                  name: abbreviation
                  type: varchar(10)
              - column:
                  name: created_at
                  type: datetime
              - column:
                  name: updated_at
                  type: datetime
            tableName: static_timezones

  - changeSet:
      id: 1589963373000-4
      author: michael-eb
      changes:
        - createTable:
            columns:
              - column:
                  name: id
                  type: binary(16)
                  constraints:
                    primaryKey: true
              - column:
                  name: comment
                  type: text
              - column:
                  name: timesheet_id
                  type: binary(16)
              - column:
                  name: employee_id
                  type: binary(16)
              - column:
                  name: created_at
                  type: datetime
              - column:
                  name: updated_at
                  type: datetime
            tableName: employee_time_entries

  - changeSet:
      id: 1589963373000-5
      author: michael-eb
      changes:
        - createTable:
            columns:
              - column:
                  name: id
                  type: binary(16)
                  constraints:
                    primaryKey: true
              - column:
                  name: start
                  type: datetime
                  constraints:
                    nullable:  false
              - column:
                  name: duration_min
                  type: int(5)
              - column:
                  name: time_type_id
                  type: binary(16)
              - column:
                  name: entry_id
                  type: binary(16)
              - column:
                  name: created_at
                  type: datetime
              - column:
                  name: updated_at
                  type: datetime
            tableName: employee_time_logs

  - changeSet:
      id: 1589963373000-6
      author: michael-eb
      changes:
        - createTable:
            columns:
              - column:
                  name: id
                  type: binary(16)
                  constraints:
                    primaryKey: true
              - column:
                  name: start_date
                  type: datetime
                  constraints:
                    nullable:  false
              - column:
                  name: end_date
                  type: datetime
                  constraints:
                    nullable:  false
              - column:
                  name: employee_id
                  type: binary(16)
              - column:
                  name: status_id
                  type: binary(16)
              - column:
                  name: approver_employee_id
                  type: binary(16)
              - column:
                  name: approved_timestamp
                  type: datetime
              - column:
                  name: user_compensation_id
                  type: binary(16)
              - column:
                  name: created_at
                  type: datetime
              - column:
                  name: updated_at
                  type: datetime
            tableName: timesheets

  - changeSet:
      id: 1589963373000-7
      author: michael-eb
      changes:
        - createTable:
            columns:
              - column:
                  name: id
                  type: binary(16)
                  constraints:
                    primaryKey: true
              - column:
                  name: name
                  type: varchar(255)
                  constraints:
                    nullable:  false
              - column:
                  name: created_at
                  type: datetime
              - column:
                  name: updated_at
                  type: datetime
            tableName: static_employees_ta_time_types

  - changeSet:
      id: 1589963373000-8
      author: michael-eb
      changes:
        - createTable:
            columns:
              - column:
                  name: id
                  type: binary(16)
                  constraints:
                    primaryKey: true
              - column:
                  name: name
                  type: varchar(255)
                  constraints:
                    nullable:  false
              - column:
                  name: created_at
                  type: datetime
              - column:
                  name: updated_at
                  type: datetime
            tableName: static_timesheet_status

  - changeSet:
      id: 1589963373000-9
      author: michael-eb
      changes:
        - createTable:
            columns:
              - column:
                  name: id
                  type: binary(16)
                  constraints:
                    primaryKey: true
              - column:
                  name: name
                  type: varchar(255)
                  constraints:
                    nullable:  false
              - column:
                  name: created_at
                  type: datetime
              - column:
                  name: updated_at
                  type: datetime
            tableName: static_company_pay_frequency_types

  - changeSet:
      id: 1589963373000-10
      author: michael-eb
      changes:
        - createTable:
            columns:
              - column:
                  name: id
                  type: binary(16)
                  constraints:
                    primaryKey: true
              - column:
                  name: name
                  type: varchar(255)
                  constraints:
                    nullable:  false
              - column:
                  name: abbreviation
                  type: varchar(10)
              - column:
                  name: created_at
                  type: datetime
              - column:
                  name: updated_at
                  type: datetime
            tableName: currencies

  - changeSet:
      id: 1589963373000-11
      author: michael-eb
      changes:
        - sql:
            sql: alter table user_compensations change column wage wage_cents bigint;

  - changeSet:
      id: 1589963373000-12
      author: michael-eb
      changes:
        - sql:
            sql: alter table user_compensations change column start_date effective_date datetime;

  - changeSet:
      id: 1589963373000-13
      author: michael-eb
      changes:
        - addColumn:
            columns:
              - column:
                  name: currency_id
                  type: BINARY(16)
            tableName: user_compensations

  - changeSet:
      id: 1589963373000-14
      author: michael-eb
      changes:
        - modifyDataType:
            columnName: overtime_status
            newDataType: BINARY(16)
            tableName: user_compensations

  - changeSet:
      id: 1589963373000-15
      author: michael-eb
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: company_id
            baseTableName: company_ta_settings
            constraintName: fk_company_ta_settings_company_id
            onDelete: RESTRICT
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: companies
        - addForeignKeyConstraint:
            baseColumnNames: time_zone_id
            baseTableName: company_ta_settings
            constraintName: fk_company_ta_settings_time_zone_id
            onDelete: SET NULL
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: static_timezones
        - addForeignKeyConstraint:
            baseColumnNames: pay_frequency_type_id
            baseTableName: company_ta_settings
            constraintName: fk_company_ta_settings_pay_frequency_type_id
            onDelete: SET NULL
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: static_company_pay_frequency_types
        - addForeignKeyConstraint:
            baseColumnNames: employee_id
            baseTableName: employees_ta_settings
            constraintName: fk_employees_ta_settings_employee_id
            onDelete: SET NULL
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: users
        - addForeignKeyConstraint:
            baseColumnNames: time_zone_id
            baseTableName: employees_ta_settings
            constraintName: fk_employees_ta_settings_time_zone_id
            onDelete: SET NULL
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: static_timezones
        - addForeignKeyConstraint:
            baseColumnNames: timesheet_id
            baseTableName: employee_time_entries
            constraintName: fk_employee_time_entries_timesheet_id
            onDelete: CASCADE
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: timesheets
        - addForeignKeyConstraint:
            baseColumnNames: employee_id
            baseTableName: employee_time_entries
            constraintName: fk_employee_time_entries_employee_id
            onDelete: SET NULL
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: users
        - addForeignKeyConstraint:
            baseColumnNames: time_type_id
            baseTableName: employee_time_logs
            constraintName: fk_employee_time_logs_time_type_id
            onDelete: SET NULL
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: static_employees_ta_time_types
        - addForeignKeyConstraint:
            baseColumnNames: entry_id
            baseTableName: employee_time_logs
            constraintName: fk_employee_time_logs_time_entry_id
            onDelete: SET NULL
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: employee_time_entries
        - addForeignKeyConstraint:
            baseColumnNames: employee_id
            baseTableName: timesheets
            constraintName: fk_timesheets_employee_id
            onDelete: SET NULL
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: users
        - addForeignKeyConstraint:
            baseColumnNames: status_id
            baseTableName: timesheets
            constraintName: fk_timesheets_status_id
            onDelete: SET NULL
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: static_timesheet_status
        - addForeignKeyConstraint:
            baseColumnNames: approver_employee_id
            baseTableName: timesheets
            constraintName: fk_timesheets_approver_employee_id
            onDelete: SET NULL
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: users
        - addForeignKeyConstraint:
            baseColumnNames: user_compensation_id
            baseTableName: timesheets
            constraintName: fk_timesheets_user_compensation_id
            onDelete: SET NULL
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: user_compensations
        - addForeignKeyConstraint:
            baseColumnNames: overtime_status
            baseTableName: user_compensations
            constraintName: fk_user_compensations_overtime_status
            onDelete: SET NULL
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: compensation_overtime_statuses
        - addForeignKeyConstraint:
            baseColumnNames: currency_id
            baseTableName: user_compensations
            constraintName: fk_user_compensations_currency_id
            onDelete: SET NULL
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: currencies

  - changeSet:
      id: 1589963373000-16
      author: michael-eb
      changes:
        - sql:
            sql: create trigger ins_static_timezones before insert on static_timezones for each row set new.id = unhex(replace(uuid(), '-', ''));

  - changeSet:
      id: 1589963373000-17
      author: michael-eb
      changes:
        - sql:
            sql: create trigger ins_static_employees_ta_time_types before insert on static_employees_ta_time_types for each row set new.id = unhex(replace(uuid(), '-', ''));

  - changeSet:
      id: 1589963373000-18
      author: michael-eb
      changes:
        - sql:
            sql: create trigger ins_static_timesheet_status before insert on static_timesheet_status for each row set new.id = unhex(replace(uuid(), '-', ''));

  - changeSet:
      id: 1589963373000-19
      author: michael-eb
      changes:
        - sql:
            sql: create trigger ins_static_company_pay_frequency_types before insert on static_company_pay_frequency_types for each row set new.id = unhex(replace(uuid(), '-', ''));

  - changeSet:
      id: 1589963373000-20
      author: michael-eb
      changes:
        - addColumn:
            columns:
              - column:
                  name: ref_id
                  type: INT
            tableName: static_timezones

  - changeSet:
      id: 1589963373000-21
      author: michael-eb
      changes:
        - addColumn:
            columns:
              - column:
                  name: ref_id
                  type: INT
            tableName: static_employees_ta_time_types

  - changeSet:
      id: 1589963373000-22
      author: michael-eb
      changes:
        - addColumn:
            columns:
              - column:
                  name: ref_id
                  type: INT
            tableName: static_timesheet_status

  - changeSet:
      id: 1589963373000-23
      author: michael-eb
      changes:
        - addColumn:
            columns:
              - column:
                  name: ref_id
                  type: INT
            tableName: static_company_pay_frequency_types

  - changeSet:
      id: 1589963373000-24
      author: michael-eb
      changes:
        - sql:
            sql: set sql_mode='';

  - changeSet:
      id: 1589963373000-25
      author: michael-eb
      runOnChange: true
      changes:
        - loadUpdateData:
            columns:
              - column:
                  name: name
                  type: STRING
            file: db/changelog/data/static_company_pay_frequency_types.csv
            primaryKey: id
            tableName: static_company_pay_frequency_types

  - changeSet:
      id: 1589963373000-26
      author: michael-eb
      runOnChange: true
      changes:
        - loadUpdateData:
            columns:
              - column:
                  name: name
                  type: STRING
            file: db/changelog/data/static_employees_ta_time_types.csv
            primaryKey: id
            tableName: static_employees_ta_time_types

  - changeSet:
      id: 1589963373000-27
      author: michael-eb
      runOnChange: true
      changes:
        - loadUpdateData:
            columns:
              - column:
                  name: name
                  type: STRING
            file: db/changelog/data/static_timesheet_status.csv
            primaryKey: id
            tableName: static_timesheet_status

  - changeSet:
      id: 1589963373000-28
      author: michael-eb
      runOnChange: true
      changes:
        - loadUpdateData:
            columns:
              - column:
                  name: name
                  type: STRING
            file: db/changelog/data/static_timezones.csv
            primaryKey: id
            tableName: static_timezones
